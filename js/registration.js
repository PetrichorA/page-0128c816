var delay=function(){var e=0;return function(a,r){clearTimeout(e),e=setTimeout(a,r)}}();function checkUserAvailable(e){var a;e.parent().next(".form-control-feedback").removeClass("glyphicon-minus").removeClass("glyphicon-remove").removeClass("glyphicon-ok").addClass("glyphicon-refresh").addClass("fa-spin"),e.closest(".has-feedback").removeClass("has-error").removeClass("has-success"),delay((function(){var r=$("#user_name").val();r.length>=3?$.ajax({method:"POST",url:"vfm-admin/ajax/usr-check.php",data:{user_name:r}}).done((function(r){a="success"==r?"glyphicon-ok":"glyphicon-remove",e.closest(".has-feedback").addClass("has-"+r),e.parent().next(".form-control-feedback").removeClass("glyphicon-refresh").removeClass("fa-spin").addClass(a)})):(e.closest(".has-feedback").addClass("has-error"),e.parent().next(".form-control-feedback").removeClass("glyphicon-refresh").removeClass("fa-spin").addClass("glyphicon-remove"))}),1e3)}$(document).on("keyup","#user_name",(function(){checkUserAvailable($(this))})),$(document).on("keyup keypress","#regform",(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),$(document).on("submit","#regform",(function(e){$regform=$(this),$regform.data("submitted",!1),e.preventDefault(),$("#regresponse").html("");var a=$("#user_pass").val(),r=$("#user_pass_check").val();if($("#agree").length&&!$("#agree").prop("checked")){var s=$("#trans_accept_terms").val();return $("#regresponse").html('<div class="alert alert-warning" role="alert">'+s+"</div>"),!1}if(a!==r){var t=$("#trans_pwd_match").val();return $("#user_pass_check").focus(),$("#regresponse").html('<div class="alert alert-warning" role="alert">'+t+"</div>"),!1}$(".mailpreload").fadeIn("fast",(function(){if(0==$regform.data("submitted")){$regform.data("submitted",!0);var e=$.now(),a=$("#regform").serialize();$.ajax({cache:!1,method:"POST",url:"vfm-admin/ajax/usr-reg.php?t="+e,data:a}).done((function(a){$("#regresponse").html(a),$("#captcha").attr("src","vfm-admin/captcha.php?"+e),$(".mailpreload").fadeOut("slow",(function(){$regform.data("submitted",!1)}))})).fail((function(){$("#regresponse").html('<div class="alert alert-danger" role="alert">error connecting user-reg.php</div>'),$("#captcha").attr("src","vfm-admin/captcha.php?"+e),$(".mailpreload").fadeOut("slow",(function(){$regform.data("submitted",!1)}))}))}}))}));